{% extends 'layout/base.html' %}
{% block content %}
<div class="container py-4">
    <h3 class="text-center text-primary mb-4 fw-bold">ğŸ’¬ ÄÃ¡nh giÃ¡ tá»« bá»‡nh nhÃ¢n</h3>

    {% if rating %}
    <div class="accordion" id="ratingsAccordion">
        {% for r in rating %}
        <div class="accordion-item shadow-sm mb-2 border-0">
            <h2 class="accordion-header" id="heading{{ r.id }}">
                <button class="accordion-button collapsed fw-semibold" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapse{{ r.id }}" aria-expanded="false" aria-controls="collapse{{ r.id }}">
                    ğŸ‘¤ {{ r.appointment.patient.full_name }} â€”
                    {% for i in range(r.stars) %}
                    <i class="fa fa-star text-warning"></i>
                    {% endfor %}

                    {% for i in range(5 - r.stars) %}
                    <i class="fa fa-star text-secondary"></i>
                    {% endfor %}
                </button>
            </h2>

            <div id="collapse{{ r.id }}" class="accordion-collapse collapse" aria-labelledby="heading{{ r.id }}"
                 data-bs-parent="#ratingsAccordion">
                <div class="accordion-body">
                    <!-- Nháº­n xÃ©t -->
                    <p class="mb-2"><strong>ğŸ“ Nháº­n xÃ©t:</strong> {{ r.comment }}</p>

                    <!-- Pháº£n há»“i -->
                    {% if r.doctor_reply %}
                    <div class="alert alert-success py-2">
                        <strong>ğŸ‘¨â€âš•ï¸ Pháº£n há»“i cá»§a báº¡n:</strong> {{ r.doctor_reply }}
                    </div>
                    {% else %}
                    <form method="post" action="{{ url_for('doctor_reply', rating_id=r.id) }}">
                        <div class="input-group mt-2">
                            <input type="text" class="form-control" name="doctor_reply" placeholder="Nháº­p pháº£n há»“i..."
                                   required>
                            <button class="btn btn-primary" type="submit">Gá»­i</button>
                        </div>
                    </form>
                    {% endif %}

                    <!-- Thá»i gian -->
                    <div class="text-end">
                        <small class="text-muted">
                            ğŸ•’ {{ r.created_date if r.created_date else '' }}
                        </small>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-info text-center shadow-sm">
        Báº¡n chÆ°a cÃ³ Ä‘Ã¡nh giÃ¡ nÃ o tá»« bá»‡nh nhÃ¢n.
    </div>
    {% endif %}
</div>
{% endblock %}